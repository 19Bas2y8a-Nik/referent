# –û—Ç—á–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: –≠—Ç–∞–ø 3 - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è API endpoint –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ AI

## –î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
–í—ã–ø–æ–ª–Ω–µ–Ω–æ: —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞

---

## –û–±–∑–æ—Ä
–≠—Ç–∞–ø 3 –≤–∫–ª—é—á–∞–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é API endpoint –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ AI —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º OpenRouter API. –í—Å–µ –∑–∞–¥–∞—á–∏ —ç—Ç–∞–ø–∞ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ —Ñ–∞–π–ª–µ `app/api/generate/route.ts`.

---

## –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### ‚úÖ 1. POST endpoint –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**–ö–æ–¥**:
```typescript
export async function POST(request: NextRequest) {
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
}
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Next.js App Router API routes
- Runtime —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ 'nodejs' –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å fetch –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç JSON body –∑–∞–ø—Ä–æ—Å–∞
- –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**–í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `title` - –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
- `content` - —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç–∞—Ç—å–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
- `action` - —Ç–∏–ø –¥–µ–π—Å—Ç–≤–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): "about", "thesis", "telegram", "translate"

**–í–∞–ª–∏–¥–∞—Ü–∏—è** (—Å—Ç—Ä–æ–∫–∏ 18-23):
```typescript
if (!title || !content || !action) {
  return NextResponse.json(
    { error: "Title, content, and action are required" },
    { status: 400 }
  );
}
```

---

### ‚úÖ 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenRouter API

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**–ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–∞** (—Å—Ç—Ä–æ–∫–∏ 25-32):
```typescript
const apiKey = process.env.OPENROUTER_API_KEY;
if (!apiKey) {
  console.error("OPENROUTER_API_KEY is not configured in environment variables");
  return NextResponse.json(
    { error: "OPENROUTER_API_KEY is not configured. Please check your .env.local file." },
    { status: 500 }
  );
}
```

**–ó–∞–ø—Ä–æ—Å –∫ OpenRouter API** (—Å—Ç—Ä–æ–∫–∏ 84-107):
```typescript
const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    "Authorization": `Bearer ${apiKey}`,
    "HTTP-Referer": process.env.NEXT_PUBLIC_APP_URL || "http://localhost:3000",
    "X-Title": "Referent App",
  },
  body: JSON.stringify({
    model: model,
    messages: [
      { role: "system", content: systemPrompt },
      { role: "user", content: userPrompt },
    ],
    temperature: 0.7,
    max_tokens: maxTokens,
  }),
});
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç OpenAI Chat Completions API
- –ü–µ—Ä–µ–¥–∞–µ—Ç HTTP-Referer –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç X-Title –∑–∞–≥–æ–ª–æ–≤–æ–∫
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç system –∏ user –ø—Ä–æ–º–ø—Ç—ã

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞** (—Å—Ç—Ä–æ–∫–∏ 131-144):
```typescript
const data = await response.json();

if (!data.choices || !data.choices[0] || !data.choices[0].message) {
  return NextResponse.json(
    { error: "Invalid response from OpenRouter API" },
    { status: 500 }
  );
}

const generatedText = data.choices[0].message.content;

return NextResponse.json({
  result: generatedText,
});
```

---

### ‚úÖ 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `action`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π 4 —Ç–∏–ø–æ–≤ –¥–µ–π—Å—Ç–≤–∏–π

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è**:
1. `"about"` - –∫—Ä–∞—Ç–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)
2. `"thesis"` - —Å–ø–∏—Å–æ–∫ —Ç–µ–∑–∏—Å–æ–≤ (5-7 –ø—É–Ω–∫—Ç–æ–≤)
3. `"telegram"` - –ø–æ—Å—Ç –¥–ª—è Telegram —Å —ç–º–æ–¥–∑–∏
4. `"translate"` - –ø–µ—Ä–µ–≤–æ–¥ —Å—Ç–∞—Ç—å–∏ (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)

**–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–µ–π—Å—Ç–≤–∏—è** (—Å—Ç—Ä–æ–∫–∏ 73-77):
```typescript
default:
  return NextResponse.json(
    { error: "Invalid action. Use 'about', 'thesis', 'telegram', or 'translate'" },
    { status: 400 }
  );
```

**–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** (—Å—Ç—Ä–æ–∫–∏ 36-45):
```typescript
let model = "openai/gpt-4o-mini";
let maxTokens = 1000;
let maxContentLength = 12000;

if (action === "translate") {
  model = "deepseek/deepseek-chat";
  maxTokens = 4000;
  maxContentLength = 16000;
}
```

---

### ‚úÖ 4. –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –¥–µ–π—Å—Ç–≤–∏—è

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏

#### 4.1 –î–µ–π—Å—Ç–≤–∏–µ "about" (–û —á–µ–º —Å—Ç–∞—Ç—å—è?)

**System Prompt** (—Å—Ç—Ä–æ–∫–∞ 58):
```
"–¢—ã –ø–æ–º–æ—â–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –∫—Ä–∞—Ç–∫–æ –æ–±—ä—è—Å–Ω—è–µ—Ç —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å—Ç–∞—Ç–µ–π. –û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –≤ –¥—Ä—É–∂–µ–ª—é–±–Ω–æ–º —Ç–æ–Ω–µ."
```

**User Prompt** (—Å—Ç—Ä–æ–∫–∞ 59):
```
–û —á–µ–º —ç—Ç–∞ —Å—Ç–∞—Ç—å—è?

–ó–∞–≥–æ–ª–æ–≤–æ–∫: ${title}

–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:
${truncatedContent}

–î–∞–π –∫—Ä–∞—Ç–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è) –æ —á–µ–º —ç—Ç–∞ —Å—Ç–∞—Ç—å—è.
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**:
- –¢–æ–Ω: –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π
- –Ø–∑—ã–∫: —Ä—É—Å—Å–∫–∏–π
- –§–æ—Ä–º–∞—Ç: 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
- –¶–µ–ª—å: –∫—Ä–∞—Ç–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è

---

#### 4.2 –î–µ–π—Å—Ç–≤–∏–µ "thesis" (–¢–µ–∑–∏—Å—ã)

**System Prompt** (—Å—Ç—Ä–æ–∫–∞ 62):
```
"–¢—ã –ø–æ–º–æ—â–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç —Ç–µ–∑–∏—Å—ã –∏–∑ —Å—Ç–∞—Ç–µ–π. –û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –§–æ—Ä–º–∞—Ç–∏—Ä—É–π —Ç–µ–∑–∏—Å—ã –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞ —Å —á–µ—Ç–∫–∏–º–∏ –ø—É–Ω–∫—Ç–∞–º–∏."
```

**User Prompt** (—Å—Ç—Ä–æ–∫–∞ 63):
```
–°–æ–∑–¥–∞–π —Ç–µ–∑–∏—Å—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏:

–ó–∞–≥–æ–ª–æ–≤–æ–∫: ${title}

–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:
${truncatedContent}

–°–æ–∑–¥–∞–π —Å–ø–∏—Å–æ–∫ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–µ–∑–∏—Å–æ–≤ (5-7 –ø—É–Ω–∫—Ç–æ–≤).
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**:
- –Ø–∑—ã–∫: —Ä—É—Å—Å–∫–∏–π
- –§–æ—Ä–º–∞—Ç: —Å–ø–∏—Å–æ–∫ —Å —á–µ—Ç–∫–∏–º–∏ –ø—É–Ω–∫—Ç–∞–º–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 5-7 –ø—É–Ω–∫—Ç–æ–≤
- –¶–µ–ª—å: –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–∑–∏—Å—ã —Å—Ç–∞—Ç—å–∏

---

#### 4.3 –î–µ–π—Å—Ç–≤–∏–µ "telegram" (–ü–æ—Å—Ç –¥–ª—è Telegram)

**System Prompt** (—Å—Ç—Ä–æ–∫–∞ 66):
```
"–¢—ã –ø–æ–º–æ—â–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç –ø–æ—Å—Ç—ã –¥–ª—è Telegram –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç–µ–π. –û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –ò—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏, –∫–æ—Ä–æ—Ç–∫–∏–µ –∞–±–∑–∞—Ü—ã –∏ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π —Å—Ç–∏–ª—å –¥–ª—è —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π."
```

**User Prompt** (—Å—Ç—Ä–æ–∫–∞ 67):
```
–°–æ–∑–¥–∞–π –ø–æ—Å—Ç –¥–ª—è Telegram –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏:

–ó–∞–≥–æ–ª–æ–≤–æ–∫: ${title}

–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:
${truncatedContent}

–°–æ–∑–¥–∞–π –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –ø–æ—Å—Ç –¥–ª—è Telegram —Å —ç–º–æ–¥–∑–∏, –∫–æ—Ç–æ—Ä—ã–π –∫—Ä–∞—Ç–∫–æ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ —Å—Ç–∞—Ç—å–µ –∏ –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ.
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**:
- –Ø–∑—ã–∫: —Ä—É—Å—Å–∫–∏–π
- –°—Ç–∏–ª—å: –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π
- –§–æ—Ä–º–∞—Ç: –∫–æ—Ä–æ—Ç–∫–∏–µ –∞–±–∑–∞—Ü—ã
- –≠–ª–µ–º–µ–Ω—Ç—ã: —ç–º–æ–¥–∑–∏
- –¶–µ–ª—å: –ø—Ä–∏–≤–ª–µ—á—å –≤–Ω–∏–º–∞–Ω–∏–µ, –∫—Ä–∞—Ç–∫–æ —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ —Å—Ç–∞—Ç—å–µ

---

#### 4.4 –î–µ–π—Å—Ç–≤–∏–µ "translate" (–ü–µ—Ä–µ–≤–æ–¥) - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ

**System Prompt** (—Å—Ç—Ä–æ–∫–∞ 70):
```
"–¢—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫. –ü–µ—Ä–µ–≤–æ–¥–∏ —Å—Ç–∞—Ç—å–∏ —Å –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫. –°–æ—Ö—Ä–∞–Ω—è–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–µ–∫—Å—Ç–∞, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–º—ã—Å–ª –æ—Ä–∏–≥–∏–Ω–∞–ª–∞. –ü–µ—Ä–µ–≤–æ–¥–∏ —Ç–æ—á–Ω–æ –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ."
```

**User Prompt** (—Å—Ç—Ä–æ–∫–∞ 71):
```
–ü–µ—Ä–µ–≤–µ–¥–∏ —ç—Ç—É —Å—Ç–∞—Ç—å—é –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫:

–ó–∞–≥–æ–ª–æ–≤–æ–∫: ${title}

–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:
${truncatedContent}

–ü–µ—Ä–µ–≤–µ–¥–∏ –≤–µ—Å—å —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏, –≤–∫–ª—é—á–∞—è –∑–∞–≥–æ–ª–æ–≤–æ–∫, –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫. –°–æ—Ö—Ä–∞–Ω–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**:
- –Ø–∑—ã–∫ –ø–µ—Ä–µ–≤–æ–¥–∞: –∞–Ω–≥–ª–∏–π—Å–∫–∏–π ‚Üí —Ä—É—Å—Å–∫–∏–π
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: —Ç–æ—á–Ω–æ—Å—Ç—å, –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ: —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–º—ã—Å–ª
- –ú–æ–¥–µ–ª—å: deepseek/deepseek-chat (—Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞)

---

### ‚úÖ 5. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è API

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**–õ–æ–≥–∏–∫–∞ –æ–±—Ä–µ–∑–∫–∏** (—Å—Ç—Ä–æ–∫–∏ 47-50):
```typescript
const truncatedContent = content.length > maxContentLength 
  ? content.substring(0, maxContentLength) + "..."
  : content;
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- –î–ª—è –æ–±—ã—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π (`about`, `thesis`, `telegram`): `maxContentLength = 12000` —Å–∏–º–≤–æ–ª–æ–≤
- –î–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ (`translate`): `maxContentLength = 16000` —Å–∏–º–≤–æ–ª–æ–≤

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –û–±—Ä–µ–∑–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¥–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–ø—Ç–∞
- –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è "..." –≤ –∫–æ–Ω—Ü–µ –æ–±—Ä–µ–∑–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ API
- –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤

---

### ‚úÖ 6. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏ (temperature, max_tokens)

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**:
- `temperature: 0.7` - –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∏ —Ç–æ—á–Ω–æ—Å—Ç—å—é
- `max_tokens: 1000` - –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
- `max_tokens: 4000` - –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞

**–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏**:
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `openai/gpt-4o-mini` - –±—ã—Å—Ç—Ä–∞—è –∏ —ç–∫–æ–Ω–æ–º–∏—á–Ω–∞—è –º–æ–¥–µ–ª—å
- –î–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞: `deepseek/deepseek-chat` - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ –∑–∞–ø—Ä–æ—Å–µ** (—Å—Ç—Ä–æ–∫–∏ 92-106):
```typescript
body: JSON.stringify({
  model: model,
  messages: [
    { role: "system", content: systemPrompt },
    { role: "user", content: userPrompt },
  ],
  temperature: 0.7,
  max_tokens: maxTokens,
}),
```

---

### ‚úÖ 7. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π

#### 7.1 –û—à–∏–±–∫–∏ HTTP –∑–∞–ø—Ä–æ—Å–∞ –∫ OpenRouter

**–û–±—Ä–∞–±–æ—Ç–∫–∞** (—Å—Ç—Ä–æ–∫–∏ 109-128):
```typescript
if (!response.ok) {
  const errorData = await response.text();
  console.error("OpenRouter API error - Status:", response.status);
  console.error("OpenRouter API error - StatusText:", response.statusText);
  console.error("OpenRouter API error - Body:", errorData);
  
  let errorMessage = `OpenRouter API error: ${response.statusText}`;
  try {
    const errorJson = JSON.parse(errorData);
    if (errorJson.error?.message) {
      errorMessage = errorJson.error.message;
    }
  } catch {
    // –ï—Å–ª–∏ –Ω–µ JSON, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—Å—Ç –∫–∞–∫ –µ—Å—Ç—å
  }
  
  return NextResponse.json(
    { error: errorMessage, details: process.env.NODE_ENV === "development" ? errorData : undefined },
    { status: response.status >= 400 && response.status < 600 ? response.status : 500 }
  );
}
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –ü—ã—Ç–∞–µ—Ç—Å—è –∏–∑–≤–ª–µ—á—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –∏–∑ JSON
- –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª—å
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- –í —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏

#### 7.2 –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞

**–û–±—Ä–∞–±–æ—Ç–∫–∞** (—Å—Ç—Ä–æ–∫–∏ 133-138):
```typescript
if (!data.choices || !data.choices[0] || !data.choices[0].message) {
  return NextResponse.json(
    { error: "Invalid response from OpenRouter API" },
    { status: 500 }
  );
}
```

#### 7.3 –û–±—â–∏–µ –æ—à–∏–±–∫–∏ (try-catch)

**–û–±—Ä–∞–±–æ—Ç–∫–∞** (—Å—Ç—Ä–æ–∫–∏ 145-164):
```typescript
catch (error) {
  console.error("Error generating text:", error);
  const errorMessage = error instanceof Error ? error.message : "Unknown error";
  const errorStack = error instanceof Error ? error.stack : undefined;
  const errorName = error instanceof Error ? error.name : "Error";
  
  console.error("Error details:", {
    name: errorName,
    message: errorMessage,
    stack: errorStack
  });
  
  return NextResponse.json(
    { 
      error: errorMessage,
      errorName: errorName,
      details: process.env.NODE_ENV === "development" ? errorStack : undefined
    },
    { status: 500 }
  );
}
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –í —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç stack trace

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–Ω–µ –≤ –ø–ª–∞–Ω–µ, –Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã)

### ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- –õ–æ–≥–∏—Ä—É–µ—Ç –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –∏ –¥–ª–∏–Ω—É –ø—Ä–æ–º–ø—Ç–∞
- –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –æ—à–∏–±–∫–∏ —Å –¥–µ—Ç–∞–ª—è–º–∏
- –õ–æ–≥–∏—Ä—É–µ—Ç –¥–ª–∏–Ω—É API –∫–ª—é—á–∞ (–±–µ–∑ —Å–∞–º–æ–≥–æ –∫–ª—é—á–∞)

### ‚úÖ –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `NEXT_PUBLIC_APP_URL`
- –†–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ª–∏–º–∏—Ç—ã —Ç–æ–∫–µ–Ω–æ–≤ –∏ –¥–ª–∏–Ω—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** (–≤ `app/page.tsx`, —Å—Ç—Ä–æ–∫–∏ 42-52):
```typescript
const generateResponse = await fetch("/api/generate", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
  },
  body: JSON.stringify({
    title: parsedData.title,
    content: parsedData.content,
    action: action,
  }),
});
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞** (—Å—Ç—Ä–æ–∫–∏ 54-67):
```typescript
if (!generateResponse.ok) {
  const errorData = await generateResponse.json().catch(() => ({ error: generateResponse.statusText }));
  throw new Error(errorData.error || `–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: ${generateResponse.statusText}`);
}

const generateData = await generateResponse.json();

if (generateData.error) {
  throw new Error(generateData.error);
}

setResult(generateData.result || "–†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –ø–æ–ª—É—á–µ–Ω");
```

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `next/server` - NextRequest, NextResponse
- OpenRouter API (–≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å)

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `OPENROUTER_API_KEY` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è, API –∫–ª—é—á –¥–ª—è OpenRouter
- `NEXT_PUBLIC_APP_URL` - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è, URL –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è HTTP-Referer

### –ú–æ–¥–µ–ª–∏ AI
- **openai/gpt-4o-mini**: –±—ã—Å—Ç—Ä–∞—è –∏ —ç–∫–æ–Ω–æ–º–∏—á–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- **deepseek/deepseek-chat**: —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- **temperature**: 0.7 (–±–∞–ª–∞–Ω—Å –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏)
- **max_tokens**: 1000 (–æ–±—ã—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è) –∏–ª–∏ 4000 (–ø–µ—Ä–µ–≤–æ–¥)

---

## –í—ã–≤–æ–¥—ã

### ‚úÖ –í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —ç—Ç–∞–ø–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:
1. ‚úÖ POST endpoint —Å–æ–∑–¥–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
2. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenRouter API –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
3. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `action` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ (4 —Ç–∏–ø–∞)
4. ‚úÖ –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –¥–µ–π—Å—Ç–≤–∏—è —Å–æ–∑–¥–∞–Ω—ã
5. ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
6. ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
7. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞

### üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è "translate"
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –†–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á

### üìä –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞
- ‚úÖ –•–æ—Ä–æ—à–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞
- ‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö edge cases
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∞–ø–∞ 3

**–û–±—â–∏–π —Å—Ç–∞—Ç—É—Å**: ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –í–´–ü–û–õ–ù–ï–ù**

–í—Å–µ –∑–∞–¥–∞—á–∏ —ç—Ç–∞–ø–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã. API endpoint –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º.

